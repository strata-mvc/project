!function($){"use strict";function initialize_map(a){var b=new google.maps.InfoWindow({maxWidth:315}),c=$(a).data("map-id"),d=gmb_data[c],e=d.map_params.latitude?d.map_params.latitude:"32.713240",f=d.map_params.longitude?d.map_params.longitude:"-117.159443",g={center:new google.maps.LatLng(e,f),zoom:parseInt(d.map_params.zoom),styles:[{stylers:[{visibility:"simplified"}]},{elementType:"labels",stylers:[{visibility:"off"}]}]};map=new google.maps.Map(a[0],g),places_service=new google.maps.places.PlacesService(map),set_map_options(map,d),set_map_theme(map,d),set_map_markers(map,d,b),"yes"===d.places_api.show_places&&perform_places_search(map,d,b)}function set_map_theme(map,map_data){var map_type=map_data.map_theme.map_type.toUpperCase(),map_theme=map_data.map_theme.map_theme_json;map.setOptions("ROADMAP"===map_type&&"none"!==map_theme?{mapTypeId:google.maps.MapTypeId.ROADMAP,styles:eval(map_theme)}:{mapTypeId:google.maps.MapTypeId[map_type],styles:!1})}function set_map_options(a,b){var c=b.map_controls.zoom_control;a.setOptions("none"===c?{zoomControl:!1}:{zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle[c]}});var d=b.map_controls.wheel_zoom;a.setOptions("none"===d?{scrollwheel:!1}:{scrollwheel:!0});var e=b.map_controls.pan_control;a.setOptions("none"===e?{panControl:!1}:{panControl:!0});var f=b.map_controls.street_view.toUpperCase();a.setOptions("NONE"===f?{streetViewControl:!1}:{streetViewControl:!0});var g=b.map_controls.double_click_zoom;a.setOptions("none"===g?{disableDoubleClickZoom:!0}:{disableDoubleClickZoom:!1});var h=b.map_controls.draggable;a.setOptions("none"===h?{draggable:!1}:{draggable:!0})}function set_map_markers(map,map_data,info_window){var map_markers=map_data.map_markers;$(map_markers).each(function(index,marker_data){var marker_icon=map_data.map_params.default_marker;"undefined"!=typeof marker_data.marker&&marker_data.marker.length>0&&(marker_icon=eval("("+marker_data.marker+")"));var marker_label="";"undefined"!=typeof marker_data.label&&marker_data.label.length>0&&(marker_label=marker_data.label);var location_marker=new Marker({map:map,zIndex:9,icon:marker_icon,label:marker_label}),marker_lat=marker_data.lat,marker_lng=marker_data.lng;location_marker.setPosition(new google.maps.LatLng(marker_lat,marker_lng)),location_marker.setVisible(!0),google.maps.event.addListener(location_marker,"click",function(){info_window.close(),info_window.setContent('<div id="infobubble-content" class="loading"></div>'),set_info_window_content(marker_data,info_window),info_window.open(map,location_marker)})})}function set_info_window_content(a,b){var c;if(a.title&&(c='<p class="place-title">'+a.title+"</p>"),a.description&&(c+='<div class="place-description">'+a.description+"</div>"),a.reference){var d={reference:a.reference};places_service.getDetails(d,function(a,d){d==google.maps.places.PlacesServiceStatus.OK&&(c+=set_place_content_in_info_window(a),c=set_info_window_wrapper(c),b.setContent(c))})}else c=set_info_window_wrapper(c),b.setContent(c)}function set_place_content_in_info_window(a){var b;return b='<div class="marker-info-wrapper">',b+=a.formatted_address?'<div class="place-address">'+a.formatted_address+"</div>":"",b+=a.formatted_phone_number?'<div class="place-phone">'+a.formatted_phone_number+"</div>":"",b+=a.website?'<div class="place-website"><a href="'+a.website+'" target="_blank" rel="nofollow" title="Click to visit the '+a.name+' website">Website</a></div>':"",a.rating&&(b+='<div class="rating-wrap clear"><p class="numeric-rating">'+a.rating+'</p><div class="star-rating-wrap"><div class="star-rating-size" style="width:'+65*a.rating/5+'px;"></div></div></div>'),b+="</div>"}function set_info_window_wrapper(a){var b='<div id="infobubble-content" class="main-place-infobubble-content">';return b+=a,b+="</div>"}function perform_places_search(a,b,c){for(var d=a.getCenter(),e=b.places_api.search_places,f=0;f<search_markers.length;f++)search_markers[f].setMap(null);if(search_markers=[],e.length>0){var g={location:new google.maps.LatLng(d.lat(),d.lng()),types:e,radius:b.places_api.search_radius};places_service.nearbySearch(g,function(b,d,e){var f,g=0;if(d==google.maps.places.PlacesServiceStatus.OK){for(g=0;f=b[g];g++)create_search_result_marker(a,b[g],c);e.hasNextPage&&e.nextPage()}})}}function create_search_result_marker(a,b,c){var d=new google.maps.Marker({map:a});d.setIcon({url:b.icon,size:new google.maps.Size(24,24),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(24,24)}),d.setPosition(b.geometry.location),d.setVisible(!0),google.maps.event.addListener(d,"click",function(){c.close(),c.setContent('<div id="infobubble-content" class="loading"></div>');var e={title:b.name,reference:b.reference};set_info_window_content(e,c),c.open(a,d)}),search_markers.push(d)}var map,places_service,place,location_marker_array=[],search_markers=[];$(function(){var a=$(".google-maps-builder");a.each(function(b){initialize_map($(a[b]))})})}(jQuery);